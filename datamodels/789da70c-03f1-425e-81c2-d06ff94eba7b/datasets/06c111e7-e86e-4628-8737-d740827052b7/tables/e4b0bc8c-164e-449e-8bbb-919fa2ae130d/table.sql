"SELECT \n\t\ttoint(FACT.AccountID)\t\tAS AccountID,\n\t\ttoint(FACT.ProductID)\t\tAS ProductID,\n\t\tP.[Annual Fee],\n\t\tP.[Total Fee],\n\t\tA.[Current Balance],\n\t\tTradeAmount,\n\t\tCASE \n\t\t\tWHEN Fact.ProductID = 9 THEN A.[Current Balance]*P.[Total Fee]\n\t\t\tWHEN Fact.ProductID = 7 OR Fact.ProductID = 8 THEN P.[Annual Fee]*TradeAmount\n\t\tELSE P.[Annual Fee]\tEND \t\t\t\t\t\t\t\t\t\t\tAS TransactionAmount,\n\t\tCREATEDATE(FACT.year,FACT.Month,Fact.Day)\t\t\t\t\t\tAS TransactionDate\nFROM \n(select\n\t\tIHLM.*,\n\t\t0\t\t\tAS TradeAmount\nFROM [Individiual_High_Loans_Match]  IHLM\nUNION \nSELECT \n\t\tIHCCM.*,\n\t\t0\t\t\tAS TradeAmount\nFROM [Individual_High_CC_Match] IHCCM\nUNION\nSELECT\n\t\tIMCCM.*,\n\t\t0\t\t\tAS TradeAmount\nFROM [Individual_Mid_CC_Match] IMCCM\nUNION\nSELECT\n\t\tIMLM.*,\n\t\t0\t\t\tAS TradeAmount\nFROM [Individual_Mid_Loans_Match] IMLM\nUNION\nSELECT\n\t\tISM.*,\n\t\t0\t\t\tAS TradeAmount\nFROM [Individual_services_Match] ISM\nUNION\nSELECT\n\t\tINSM.*,\n\t\t0\t\t\tAS TradeAmount\nFROM [Institute_Annual_Match] INSM\nUnion\nselect\n\t\tATM.*,\n\t\t0\t\t\tAS TradeAmount\nFROM [ATM_WithDrawal.csv] ATM\nUNION\nSELECT\n\t\tINSSM.*\nFROM [Institute_services_Match] INSSM ) FACT\nINNER JOIN [Product] P ON Fact.productID = P.ProductID INNER JOIN [Accounts] A ON Fact.AccountID = A.AccountID"